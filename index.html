<!DOCTYPE html>
<html lang="en">
	<head>

		<style>
			.map {
				width: 100%;
				height:100%;
				display: block;
				position: absolute;
			}
		</style>

		<script src="build/ol.js"></script>
		<include src="build/ol.html"/>

	</head>

	<body>
		<ol-map id="map" class="map">

			<select style="position:absolute;right:15px;top:15px;z-index:999" slot="map-viewport" class="x-dropdown" style="width:100%;">
				<option>Maptiler CLOUD</option>
			</select>

			<ol-tile-osm></ol-tile-osm>

			<ol-layer-vector id="vector"/>

		</ol-map>

		<script>
			document.addEventListener("DOMContentLoaded", function(){
				const element = document.getElementById('vector')
				const layer = element.getLayer()

				const dataset = new ol.source.Vector({features: []});

				layer.setSource(new ol.source.Cluster({
					distance: 35,
					source: dataset
				}));
				layer.setVisible(true);

				const features = [];
				const vehicle = new ol.trackpoint.VehicleMarker({
					type:         'BLACK',
					displayArrow: true,
					direction:    0,
					label:        '123',
					ll:           [0,0],
					tail:         true
				});

				features.push(vehicle)

				dataset.addFeatures(features);



				const map = element.getMap();

				map.on("click", function(event) {
					const is_feature = map.forEachFeatureAtPixel(event.pixel, function(feature, layer) {

						if (layer) {
							return true;
						}
					});

					console.log(is_feature);
				});

			});
		</script>
	</body>
</html>
